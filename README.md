<!-- This readme is generated by running `Companion.exe -GenerateReadme` -->
# Ficsit Remote Monitoring Companion

Ficsit Remote Monitoring Companion (FRMC) is a companion application for the 
[Ficsit Remote Montioring mod](https://ficsit.app/mod/B9bEiZFtaaQZHU) 
for [Satisfactory](https://www.satisfactorygame.com/).

The Ficsit Remote Monitoring mod exports metrics about the loaded save in 
Satisfactory, via a web server serving JSON. This companion application 
provides a visulisation tool on top of those metrics.

## Installation instructions
See [installation instructions](./InstallationInstructions.md)

## How do I use it?
FRMC offers two tools for visualising the data being collected:

1. [The realtime map](http://localhost:8000)*
1. [The Prometheus metrics server](http://localhost:9090)*

The realtime map shows your factory buildings on the Satisfactory game world map, and charts their production levels in the last 5 minutes. 

The [Prometheus metrics server](https://prometheus.io/) allows you to [explore the data being exported](https://prometheus.io/docs/prometheus/latest/querying/basics) using the full power of Prometheus.

(&#42; Link goes to the address on your local system. If FRMC is not running, you will see an error)

### Env vars

`FRM_HOST`: The host to the Ficsit Remote Monitoring server. EG: `172.17.0.1`.

`FRM_PORT`: The port of the Ficist Remote Monitoring server. EG: `8080`.

`FRM_HOSTS`: A comma separated list of Ficsit Remote Monitoring servers. If protocol is unspecified, it defaults to http. EG: `http://myserver1.frm.example:8080,myserver2.frm.example:8080,https://myserver3.frm.example:8081`

`FRM_LOG_STDOUT`: If FRMC should print to stdout rather than a separate logfile. Useful for docker/containerization. default false.

## What metrics are available


<table>
    <thead>
        <tr>
            <th>Name</th>
            <th>Description</th>
            <th>Labels</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>drone_port_fuel_rate</td>
            <td>无人机平台燃料消耗率</td>
            <td>id, home_station, fuel_name, url, session_name</td>
        </tr>
        <tr>
            <td>drone_port_fuel_amount</td>
            <td>无人机平台库存中的燃料量</td>
            <td>id, home_station, fuel_name, url, session_name</td>
        </tr>
        <tr>
            <td>drone_port_round_trip_seconds</td>
            <td>记录无人机往返时间（秒）</td>
            <td>id, home_station, paired_station, url, session_name</td>
        </tr>
        <tr>
            <td>drone_port_power</td>
            <td>无人机平台当前消耗电力，单位为 MW</td>
            <td>circuit_id, url, session_name</td>
        </tr>
        <tr>
            <td>drone_port_power_max</td>
            <td>无人机平台最大消耗电力，单位为 MW</td>
            <td>circuit_id, url, session_name</td>
        </tr>
        <tr>
            <td>extractor_power</td>
            <td>提取器当前消耗电力，单位为 MW</td>
            <td>circuit_id, url, session_name</td>
        </tr>
        <tr>
            <td>extractor_power_max</td>
            <td>提取器最大消耗电力，单位为 MW</td>
            <td>circuit_id, url, session_name</td>
        </tr>
        <tr>
            <td>machine_items_produced_per_min</td>
            <td>建筑物当前每分钟生产多少物品</td>
            <td>item_name, machine_name, x, y, z, url, session_name</td>
        </tr>
        <tr>
            <td>machine_items_produced_pc</td>
            <td>建筑物生产物品的效率</td>
            <td>item_name, machine_name, x, y, z, url, session_name</td>
        </tr>
        <tr>
            <td>factory_power</td>
            <td>工厂机器的电力消耗，单位为 MW。不包括提取设备。</td>
            <td>circuit_id, url, session_name</td>
        </tr>
        <tr>
            <td>factory_power_max</td>
            <td>工厂机器的最大电力消耗，单位为 MW。不包括提取器。</td>
            <td>circuit_id, url, session_name</td>
        </tr>
        <tr>
            <td>fracking_power</td>
            <td>fracking power use in MW</td>
            <td>circuit_id, url, session_name</td>
        </tr>
        <tr>
            <td>fracking_power_max</td>
            <td>fracking max power use in MW</td>
            <td>circuit_id, url, session_name</td>
        </tr>
        <tr>
            <td>hypertube_power</td>
            <td>hypertube power use in MW</td>
            <td>circuit_id, url, session_name</td>
        </tr>
        <tr>
            <td>hypertube_power_max</td>
            <td>hypertube max power use in MW</td>
            <td>circuit_id, url, session_name</td>
        </tr>
        <tr>
            <td>item_production_capacity_per_min</td>
            <td>物品每分钟生产效率百分比</td>
            <td>item_name, url, session_name</td>
        </tr>
        <tr>
            <td>item_production_capacity_pc</td>
            <td>物品理论最大产量</td>
            <td>item_name, url, session_name</td>
        </tr>
        <tr>
            <td>item_consumption_capacity_per_min</td>
            <td>物品每分钟消耗效率百分比</td>
            <td>item_name, url, session_name</td>
        </tr>
        <tr>
            <td>item_consumption_capacity_pc</td>
            <td>物品理论最大消耗量</td>
            <td>item_name, url, session_name</td>
        </tr>
        <tr>
            <td>items_produced_per_min</td>
            <td>物品当前每分钟产量</td>
            <td>item_name, url, session_name</td>
        </tr>
        <tr>
            <td>items_consumed_per_min</td>
            <td>物品当前消耗量</td>
            <td>item_name, url, session_name</td>
        </tr>
        <tr>
            <td>power_consumed</td>
            <td>选定电路的当前电力消耗</td>
            <td>circuit_id, url, session_name</td>
        </tr>
        <tr>
            <td>power_capacity</td>
            <td>选定电路的电力理论最大值</td>
            <td>circuit_id, url, session_name</td>
        </tr>
        <tr>
            <td>power_max_consumed</td>
            <td>选定电路的最小消耗电量(需要这么多才能启动)</td>
            <td>circuit_id, url, session_name</td>
        </tr>
        <tr>
            <td>battery_differential</td>
            <td>电池组输入或输出的电量盈余或不足。正值表示给电池充电，负值表示消耗电池电量。</td>
            <td>circuit_id, url, session_name</td>
        </tr>
        <tr>
            <td>battery_percent</td>
            <td>电池组充电百分比</td>
            <td>circuit_id, url, session_name</td>
        </tr>
        <tr>
            <td>battery_capacity</td>
            <td>电池组总容量</td>
            <td>circuit_id, url, session_name</td>
        </tr>
        <tr>
            <td>battery_seconds_empty</td>
            <td>电池耗尽还有多少秒</td>
            <td>circuit_id, url, session_name</td>
        </tr>
        <tr>
            <td>battery_seconds_full</td>
            <td>电池充满所需秒数</td>
            <td>circuit_id, url, session_name</td>
        </tr>
        <tr>
            <td>fuse_triggered</td>
            <td>保险丝被触发了吗</td>
            <td>circuit_id, url, session_name</td>
        </tr>
        <tr>
            <td>portal_power</td>
            <td>传送门当前消耗电力，单位为 MW</td>
            <td>circuit_id, url, session_name</td>
        </tr>
        <tr>
            <td>portal_power_max</td>
            <td>传送门最大消耗电力，单位为 MW</td>
            <td>circuit_id, url, session_name</td>
        </tr>
        <tr>
            <td>pump_power</td>
            <td>水泵当前消耗电力，单位为 MW</td>
            <td>circuit_id, url, session_name</td>
        </tr>
        <tr>
            <td>pump_power_max</td>
            <td>水泵最大消耗电力，单位为 MW</td>
            <td>circuit_id, url, session_name</td>
        </tr>
        <tr>
            <td>resource_sink_power</td>
            <td>AWESOME当前消耗电力，单位为 MW</td>
            <td>circuit_id, url, session_name</td>
        </tr>
        <tr>
            <td>resource_sink_power_max</td>
            <td>AWESOME最大消耗电力，单位为 MW</td>
            <td>circuit_id, url, session_name</td>
        </tr>
        <tr>
            <td>resource_sink_total_points</td>
            <td>AWESOME 累计积分总数</td>
            <td>sink_type, url, session_name</td>
        </tr>
        <tr>
            <td>resource_sink_points_to_coupon</td>
            <td>AWESOME 下一张优惠劵的积分数</td>
            <td>sink_type, url, session_name</td>
        </tr>
        <tr>
            <td>resource_sink_percent</td>
            <td>AWESOME 下一张优惠券的进度百分比</td>
            <td>sink_type, url, session_name</td>
        </tr>
        <tr>
            <td>resource_sink_collected_coupons</td>
            <td>AWESOME 里的优惠券数量</td>
            <td>url, session_name</td>
        </tr>
        <tr>
            <td>train_round_trip_seconds</td>
            <td>Recorded train round trip time in seconds</td>
            <td>name, url, session_name</td>
        </tr>
        <tr>
            <td>train_segment_trip_seconds</td>
            <td>Recorded train trip between two stations</td>
            <td>name, from, to, url, session_name</td>
        </tr>
        <tr>
            <td>train_derailed</td>
            <td>Is train derailed</td>
            <td>name, url, session_name</td>
        </tr>
        <tr>
            <td>train_power_consumed</td>
            <td>How much power train is consuming</td>
            <td>name, url, session_name</td>
        </tr>
        <tr>
            <td>train_power_circuit_consumed</td>
            <td>How much power all trains are consuming in a circuit</td>
            <td>circuit_id, url, session_name</td>
        </tr>
        <tr>
            <td>train_power_circuit_consumed_max</td>
            <td>Maximum power all trains can consume on a circuit</td>
            <td>circuit_id, url, session_name</td>
        </tr>
        <tr>
            <td>train_total_mass</td>
            <td>Total mass of the train</td>
            <td>name, url, session_name</td>
        </tr>
        <tr>
            <td>train_payload_mass</td>
            <td>Current payload mass of the train</td>
            <td>name, url, session_name</td>
        </tr>
        <tr>
            <td>train_max_payload_mass</td>
            <td>Max payload mass of the train</td>
            <td>name, url, session_name</td>
        </tr>
        <tr>
            <td>train_station_power</td>
            <td>Train station power consumed in MW</td>
            <td>circuit_id, url, session_name</td>
        </tr>
        <tr>
            <td>train_station_power_max</td>
            <td>Train station power max consumed in MW</td>
            <td>circuit_id, url, session_name</td>
        </tr>
        <tr>
            <td>vehicle_round_trip_seconds</td>
            <td>Recorded vehicle round trip time in seconds</td>
            <td>id, vehicle_type, path_name, url, session_name</td>
        </tr>
        <tr>
            <td>vehicle_fuel</td>
            <td>Amount of fuel remaining</td>
            <td>id, vehicle_type, fuel_type, url, session_name</td>
        </tr>
        <tr>
            <td>vehicle_station_power</td>
            <td>Vehicle station power use in MW</td>
            <td>circuit_id, url, session_name</td>
        </tr>
        <tr>
            <td>vehicle_station_power_max</td>
            <td>Vehicle station max power use in MW</td>
            <td>circuit_id, url, session_name</td>
        </tr>
	</tbody>
</table>


## How it works
Ficsit Remote Monitoring Companion reads metric data from the Ficsit Remote Montioring mod, stores it in a local Prometheus instance, and enables to users to visualise it using a realtime map or the Prometheus query interface.

## Building FRMC
To build FRMC, run `make` from the `Companion/` directory. This will download all the necessary dependencies and build FRMC.

## Commit guidlines
Commits should contain a title on the first line, followed by a blank line, followed by as much detail as necessary to undertstand what the commit does and why. Lines should avoid being more than 80 characters wide.

Commit titles prefixed with `feat:`, `fix:` or `improvement:` will appear in the release notes. If a change sensibly spans multiple commits, either use the last commit to add informationt to the release notes, or use en empty commit.

An example of a good commit looks like this

```
Update building data in marker popups on each request

Previously, the map was requesting new data regularly but wasn't
updating the marker contents. This meant that if a building's recipe
changed, it would never be reflected in the map.
```
